const cart = [];

async function fetchProducts() {
    const response = await fetch('http://127.0.0.1:8000/api/products/'); // Update URL if needed
    const products = await response.json();
    displayProducts(products);
}

function displayProducts(products) {
    const productsDiv = document.getElementById('products');
    productsDiv.innerHTML = '';
    products.forEach(product => {
        const div = document.createElement('div');
        div.className = 'product';
        div.innerHTML = `
            <h3>${product.name}</h3>
            <p>${product.description}</p>
            <p><strong>$${product.price}</strong></p>
            <button onclick="addToCart(${product.id}, '${product.name}', ${product.price})">Add to Cart</button>
            <button onclick="viewDetails('${product.name}', '${product.description}', ${product.price})">View Details</button>
        `;
        productsDiv.appendChild(div);
    });
}

function addToCart(id, name, price) {
    cart.push({ id, name, price });
    updateCart();
}

function updateCart() {
    const cartItems = document.getElementById('cart-items');
    const cartTotal = document.getElementById('cart-total');
    cartItems.innerHTML = '';
    let total = 0;
    cart.forEach(item => {
        const li = document.createElement('li');
        li.textContent = `${item.name} - $${item.price}`;
        cartItems.appendChild(li);
        total += item.price;
    });
    cartTotal.textContent = total.toFixed(2);
}

function viewDetails(name, description, price) {
    alert(`Product: ${name}\nDescription: ${description}\nPrice: $${price}`);
}

function processOrder() {
    if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
    }
    alert("Order placed successfully! Thank you for shopping.");
    cart.length = 0;
    updateCart();
}

fetchProducts();
